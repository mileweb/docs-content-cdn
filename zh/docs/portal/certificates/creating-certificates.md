# 创建服务端证书

目前有三种方式进行服务端证书的创建: 

1. **自动生成自签名证书** 使用本方式可以生成一份自签名证书给您的加速项目临时使用，或用于测试。它的另一个重要用途是生成一份新的证书签名请求（CSR）来向证书颁发机构（CA）申请正式证书。在自签名证书生成以后，您可以下载它对应的 CSR 并将其提交给 CA。当您收到 CA 签署的正式证书和链证书时，您可以将它们作为新版本上传并部署。

2. **上传已有的私钥、证书以及链证书**


## 自动生成自签名证书

以下过程描述了如何生成自签名证书。在将证书部署到生产环境之前，自签名证书可用于测试或内部使用。如果您需要使用 CSR 从 CA 申请签名，您需要先创建一份自签名证书。


1. 在左边菜单栏，点击 **证书** 菜单，选择 **服务端证书**。
2. 在服务端证书页面的右上方，点击 **创建证书** 按钮。

<p align=center><img src="/docs/resources/images/certificates/certificates-wo-numbers.png" alt="create new cert button menu" width="900"></p>


3. 填写“创建证书”页面顶部的必填信息。在 **创建方法** 旁边，点击 **自动生成** 并填写其他字段。必填字段用星号 (\*)进行了标注。

<p align=center><img src="/docs/resources/images/certificates/create-certificate-autogenerate.png" alt="auto generate cert" width="650"></p>

| **字段**|**描述**|
|-|-|
|| **创建证书页面上方的字段**                                      |
|证书名称|输入证书名称，该名称用于标识不同证书。|
|证书说明|为该证书添加说明信息。|
|自动更新|请选择您是否需要CDN Pro 通过Let's Encrypt (**LE**) [自动更新证书](/docs/portal/certificates/auto-renewal.md)。|
|与下列客户共享|此字段仅供代理商类型客户使用。它允许代理商将该证书共享给指定的子客户。|
|创建方式|指定是要上传已有的证书还是使用 CDN Pro 生成自签名证书。
|| **选择自动生成后展示的字段**                                      |
|模板|使用所选模板的预设内容来填充后续表单字段。模板是常用设置的集合。在使用此选项之前，您必须至少保存一个模板（请参阅下面的第 4 步）。使用模板中的设置填充后续表单字段后，您可以按您的实际要求对在字段中的值进行修改，然后将设置保存到新模板中。|
|公钥算法|为该证书选择一个公钥算法： RSA2048 或者 ECC256.|
|通用名|输入要用于证书的通用名（可以是任何文本）。|
|多域名信息|输入一个或多个域名名称 (SAN)，这将是您希望关联该证书的加速域名。|
|国家|输入 [ISO-3166 国家代码](<https://www.iso.org/obp/ui/#search>) 格式的国家/地区名称，通常值格式为两个字母。|
|州|输入省、州名。|
|城市|输入城市名。|
|街道|输入街道名|
|公司|输入公司名。|
|部门|输入部门名。|
|Email|输入邮箱地址。|
|注释|为这个证书版本添加必要的注释信息。|

4. 如果您想将这些设置保存到模板中（以便后续可以使用上面提到的 **模板** 下拉快速选择功能进行内容填充），请点击 **另存为模板** 按钮。当弹出确认提示时，输入模板的名称并点击**确定**。

5. 点击 **保存** 按钮。

此时您的证书已成功保存并显示在了证书页面上。您现在可以将此证书与您创建的对应加速项目一起使用，并将其部署到演练和生产环境。您也可以下载 CSR 以此向 CA 申请签名证书，然后将收到的签名证书上传并创建一个[新证书版本](</docs/portal/certificates/updating-certificates.md>)。


## 上传一本已有证书

如果您已经拥有包含私钥和 CA 链证书的证书，您可以直接上传它们以便在加速项目中使用它们。在执行以下步骤之前，请确保证书和相关文件采用隐私增强邮件 (**PEM**) 格式。文件的内容应该是纯文本，并以五个等号 (`======`) 开头。

上传文件并保存为新证书:

1. 在左边菜单栏，点击 **证书** 菜单，选择 **服务端证书**。<br>
2. 在证书页面的右上方，点击 **创建证书** 按钮。 

<p align=center><img src="/docs/resources/images/certificates/certificates-wo-numbers.png" alt="Create new certi button" width="900"></p>

3. 填写“创建证书”页面顶部的必填信息。在 **创建方法** 旁边，点击 **上传** 并选择上传的私钥文件、证书文件以及CA文件。必填字段用星号 (\*)进行了标注。

<p align="center"><img src="/docs/resources/images/certificates/create-certificate-upload.png" alt="Upload Certificate" width="600"></p>

4. 点击 **保存** 按钮。

此时您的证书已成功保存，该证书可被用在您创建的对应加速项目中。

## 通过DNS-01挑战申请证书

通过 **DNS-01 挑战** 的方式，您可以从CA申请签发有效的证书。申请证书时，需验证域名的控制权。您需要为证书中的每个域名在您的DNS上创建TXT记录用于验证。验证成功，证书签发后，您可以删除掉对应的TXT记录。

通过DNS-01挑战申请证书：

1. 在左边菜单栏，点击 **证书** 菜单，选择 **服务端证书**。<br>
2. 在证书页面的右上方，点击 **创建证书** 按钮。 

<p align=center><img src="/docs/resources/images/certificates/certificates-wo-numbers.png" alt="Create new certificate button" width="900"></p>

3. 填写“创建证书”页面顶部的必填信息。在 **创建方法** 旁边，点击 **DNS-01 挑战**。
   
<p align="center"><img src="/docs/resources/images/certificates/ds01-challenge-option.png" alt="DS01 Challenge" width="600"></p>

4. 在 **SAN** 字段，输入域名。如果有多个域名，则用逗号分隔。

5. 点击 **保存** 按钮，弹出 **验证 ACME 挑战** 窗口。您需要按提示创建DNS TXT记录。DNS挑战通过，证书签发成功后，CDN Pro 将自动上传保存证书。您可将证书用于加速项目中。 
   
**注意：** 由于DNS记录生效耗时较久，该过程可能持续几分钟时间。
